<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>HomeSlice</title>
<meta name="viewport" content="width=device-width">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes" /> 
<link href='http://fonts.googleapis.com/css?family=Varela+Round|Signika:400,300|Oxygen:400,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="jquery-ui-1.10.4.custom.css" />
<link rel="stylesheet" type="text/css" href="main.css" />
<link rel="stylesheet" type="text/css" href="profile.css" />
<link rel="stylesheet" type="text/css" href="messages.css" />
<link rel="stylesheet" type="text/css" href="matches.css" />
<link rel="stylesheet" type="text/css" href="expats.css" />
<link rel="stylesheet" type="text/css" href="homies.css" />
<link rel="stylesheet" type="text/css" href="help.css" />
<script src="javascript/jquery.js"></script>
<script src="javascript/jquery-ui.js"></script>
<script src="javascript/jquery.cookie.js"></script>
<script type="text/javascript">
$.extend({
    getUrlVars : function() {
        var vars = [], hash;
        var hashes = window.location.href.slice(
                window.location.href.indexOf('?') + 1).split('&');
        for ( var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }
        return vars;
    },
    getUrlVar : function(name) {
        return $.getUrlVars()[name];
    }
});

$(document).ready(function() {
    $('#content').load('views/' + $.getUrlVar('page').replace("/", "").replace("#", "") + '.html');
	$('.' + $.getUrlVar('page').replace("/", "").replace("#", "") + '_page_link').addClass("selected");
});

$(function() {
    $("#get_matched_button").click(function(evt) {
        var matchProgress = $.cookie("match_progress");
        if (matchProgress == undefined) {
            matchProgress = "1";
        }
        window.location.href = "index.html?page=matches"+matchProgress;
    });
});
</script>
<script type="text/javascript">
// Insert optional override object before the function

createGridder = function() {
  document.body.appendChild(
    document.createElement('script'))
    .src='javascript/gridder.js';
}

var gOverride = {
  urlBase: 'http://gridder.andreehansson.se/releases/latest/',
  gColor: '#EEEEEE',
  gColumns:12,
  gOpacity: 0.35,
  gWidth: 10,
  pColor: '#C0C0C0',
  pHeight: 15,
  pOffset: 0,
  pOpacity: 0.55,
  center: true,
  gEnabled: true,
  pEnabled: true,
  setupEnabled: true,
  fixFlash: true,
  size: 960
};
</script>
<script type="text/javascript">
//$.widget( "ui.dialog", $.ui.dialog, {
//    open: function() {
//        this._super();
//        $( "html" ).css( "overflow", "hidden" );
//        $( "#profile_popup" ).css( "display", "" );
//    },
//    close: function() {
//        this._super();     
//        $( "html" ).css( "overflow", "visible" );
//    }
//});
    
var profile = function(index) {
    var title = "user"+index;
    
    if ($.cookie(title) != undefined) {
        $("#profile_like_button").html("&#9733;");
    } else {
        $("#profile_like_button").html("&#9734;");
    }
    
    if (title != "user-1") {
        $.getJSON("users.json", function(data) {
            var user = data[index][0].user;
            var username = user.name.first.capitalize() + " " +  user.name.last[0].capitalize() + ".";
            var city = user.location.city.capitalize() + ", " + user.location.state;
            
            $("#profile_pic").prop("src", user.picture);
            $("#profile_name").text(username);
            $("#profile_from").text(city);
        });
    }
    
    var popupHeight = 600;
    var offset = $(window).height()/2 - 64.5 - popupHeight/2 - $(window).height()/40 + $(window).scrollTop();
    var position = "center top+" + offset;
    $("#profile_popup").dialog({
        height: popupHeight,
        width: 575,
        modal: true,
        dialogClass: "profile_popup",
        draggable: false,
    }).parent()
    .position({
        my: "center top+" + offset,
        of: "#controls",
    });
    
    $("#profile_popup").data("user", title);
}
</script>
</head>

<body onload="//createGridder()">
	
    <div id="profile_popup" style="display: none">
        <div id="profile_info">
            <img id="profile_pic" src="http://img2.wikia.nocookie.net/__cb20140129024919/rickandmorty/images/b/bb/Rickpic.png" alt="Rick S.">
            <h1 id="profile_name">Rick S.</h1>
            <h3 id="profile_from_title">originally<br>from</h3>
            <h2 id="profile_from">Earth Dimension C-137</h2>
            <button id="profile_like_button">&#9734;</button>
        </div>
        <div id="profile_likes_div">
            <h2 id="likes_header">Likes</h2>
            <ul id="profile_likes">
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
                <li id="like_item"><img id="like_img" src="http://www.hudsonfla.com/hstusflag.jpg" alt="Amurica!"><h3 id="like_text">The United States</h3></li>
            </ul>
        </div>
        
        <script type="text/javascript">
            $("#profile_like_button").click(function(evt) {
                if ($("#profile_like_button").text() === "â˜†") {
                    $("#profile_like_button").html("&#9733;");
                    $.cookie($("#profile_popup").data("user"), "liked");
                } 
                else {
                    $("#profile_like_button").html("&#9734;");
                    $.removeCookie($("#profile_popup").data("user"));
                }
            });
        </script>
    </div>
    
	<section id="container">

		<section id="main_sidebar">
			<a id="logo" href="?page=expats" title="HomeSlice"><img src="images/logo_small_no_flag.png" alt="HomeSlice" /></a>
			
			<ul id="main_navigation">
				<li><a href="?page=expats" title="Expats" class="expats_page_link">Expats</a></li>
				<li><a href="?page=homies" title="Homies" class="homies_page_link">Homies</a></li>
				<li><a href="?page=help" title="Help" class="help_page_link">Help</a></li>
			</ul>
		</section>
	
		<section id="main_content">
			<div id="controls">
				
				<a href="?page=profile" title="Profile" class="profile_link">
					<div id="user_small_thumb_container">
						<div style="background: url(images/user_small.jpg) no-repeat center center"></div>
					</div>
					<p class="username">Emily</p>
				</a>
				
				<a href="?page=messages" title="Messages" class="messages_link">
					<img src="images/envelope_white.png" alt="envelope" width="35" style="opacity: .1" />
				</a>

			</div>
			<div id="content">
				
			</div>
            
		</section>
	
		<footer>
			<img src="images/flag_light.png" alt="flag" />
			<p>MIT 6.813 Class Project. &copy; 2014</p>
		</footer>
	
	</section>

<script type="text/javascript">
$(function() {

	switch($.cookie("match_progress")) {
		case "2":
			$("#controls").append('<button class="control_button" id="matches_requested_pending_button">Match requested, pending</button>');
			break;
		case "3":
			$("#controls").append('<button class="control_button" id="matches_ready_button">Matches ready!</button>');
			break;
		case "4":
			$("#controls").append('<button class="control_button" id="post_hangout_button">Tell us how your hangout went</button>');
			break;
		case "1":
		default:
			$("#controls").append('<button class="control_button" id="get_matched_button">Get Matched</button>');
			break;
	}
});
</script>

</body>

</html>
